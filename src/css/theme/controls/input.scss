$input-height: $space-10;
$field-background: transparent;
$input-radius: $radius-2;
$field-disabled-background: transparent;
$q-field__label_height: 24px; /* update on change of label typography */
$q-field__label_margin_bottom: $space-1;

@mixin q-field__prepend_and_append_icon_style {
  $icon-size: $space-6;

  font-family: Phosphor, serif !important;
  speak: never;
  font-style: normal;
  font-weight: normal;
  font-variant: normal;
  text-transform: none;
  line-height: 1;
  -webkit-font-smoothing: antialiased;
  overflow: hidden;
  width: $icon-size;
  height: $icon-size;

  &::before {
    position: absolute;
    left: 0;
    background: $field-background;
  }
}

@mixin q-field__prepend_and_append_btn_style {
  .q-btn {
    $btn-height: $input-height;
    max-height: $btn-height !important;
    min-height: $btn-height !important;
  }
}

@mixin q-field-mixin {
  align-items: flex-end;
  margin-top: $space-2;

  $border-style: 1.5px solid $light-outline;
  $disbaled-border-style: 1.5px solid $light-disable;
  $field-container-padding-x: $space-4;

  .q-field__inner {
    .q-field__control {
      //height: $input-height;
      height: max-content;
      min-height: $input-height;
      position: relative;
      align-items: center;
      padding: 0 $space-2 0 $space-2;
      //margin-top: calc(
      //  #{$q-field__label_height} + #{$q-field__label_margin_bottom}
      //);
      margin-top: 0;

      &::before {
        content: ' ';
        inset: auto 0 0;
        width: 100%;
        z-index: 1;
        position: absolute;
        background: $field-background;
        height: 100%;
        border-radius: $input-radius;
        border: $border-style;
      }

      &::after {
        display: none;
      }

      .q-field__prepend {
        @include q-field__prepend_and_append_btn_style();
        height: $input-height;
        padding-right: $spacing-none;
        z-index: 2;
      }

      .q-field__control-container {
        flex-wrap: wrap;
        position: unset;
        padding-top: 0;
        .q-field__native {
          color: $color-text1;
          // height: $input-height;
          // min-height: $input-height;
          order: 2;
          z-index: 2;
          overflow: hidden;
          white-space: nowrap;
          padding: $spacing-none $field-container-padding-x;

          span {
            position: absolute;
          }

          &[type='number']::-webkit-outer-spin-button,
          &[type='number']::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
          }

          &[type='number'] {
            -moz-appearance: textfield;
          }

          &::placeholder {
            color: $color-text3;
            @include typo-body-3;
          }
          &:-webkit-autofill,
          &:-webkit-autofill:hover,
          &:-webkit-autofill:focus,
          &:-webkit-autofill:active {
            -webkit-background-clip: text;
            -webkit-animation-delay: 1s; /* Safari support - any positive time runs instantly */
            -webkit-animation-name: webkit-autofill-animation;
            -webkit-animation-fill-mode: both;
            @-webkit-keyframes webkit-autofill-animation {
              0%,
              100% {
                color: #666;
                background: transparent;
              }
            }
          }
          @include typo-body-3;
        }

        .q-field__label {
          order: 1;
          transition: 200ms;
          transition-timing-function: linear;
          color: $color-text3;
          max-width: 100%;
          //transform: translateY(calc(-100% - #{$q-field__label_margin_bottom})) scale(1);
          // transform: translateY(-50%) translateX($space-1) scale(1);
          position: absolute;
          top: 0;
          z-index: 1;
          background: $color-surface;
          padding: 0 $space-1;
          @include typo-body-3;
        }
      }

      .q-field__append {
        height: $input-height;
        padding-left: $spacing-none;
        z-index: 2;
        @include q-field__prepend_and_append_btn_style();
        .OMS-Icon {
          opacity: 0.6;
          color: $neutral-30;
          &:hover {
            opacity: 1;
          }
        }
        // .q-field__focusable-action{
        //   font-family: OMS-Icon;
        //   color: transparent;
        //   &::before{
        //     content: "\e915";
        //     color: $neutral-30;
        //     position: absolute;
        //   }
        // }
      }
    }

    .q-field__bottom {
      //padding-top: $space-1;
      padding-top: 0;

      .q-field__messages {
        @include typo-body-4;
        & {
          color: $grey-6;
          margin-top: $space-1;
          padding-left: $space-4;
        }
      }
    }
  }
  &.q-field--float {
    .q-field__inner {
      .q-field__control {
        .q-field__control-container {
          .q-field__label {
            top: 0;
            left: $space-3;
            transform: translateY(-50%) scale(1);
            @include typo-body-4;
          }
          .q-field__native::placeholder {
            color: transparent;
          }
        }
      }
    }
  }

  &.ltr {
    .q-field__inner {
      .q-field__control {
        .q-field__control-container {
          .q-field__native {
            text-align: right;
            direction: rtl;
          }
        }
      }
      .q-field__bottom {
        .q-field__messages {
          div:not([role='alert']) {
            color: $color-text2;
          }
        }
      }
    }
  }

  &:not(.q-field--float) {
    .q-field__inner {
      .q-field__control {
        .q-field__control-container {
          position: relative;
          .q-field__label {
            position: absolute;
            background: transparent;
            left: $field-container-padding-x;
          }
          .q-field__native::placeholder {
            color: transparent;
          }
        }
      }
    }
  }

  &.q-field--filled {
    .q-field__inner {
      .q-field__control {
        background: $primary-10;
        border-radius: $input-radius;
      }
    }
  }

  &.q-field--standard {
    &.q-field--readonly {
      .q-field__control {
        &::before {
          border-bottom: $border-style;
        }
      }
    }
  }

  &.q-field--focused {
    .q-field__inner {
      .q-field__control {
        &::before {
          border-color: $primary;
        }
      }
    }
  }

  &.q-field--disabled {
    .q-field__inner {
      .q-field__control {
        $field-disabled-input-color: $grey-4;
        &::before {
          background: $field-disabled-background;
          border: $disbaled-border-style;
        }
        & > div {
          opacity: 1 !important;
        }
        .q-field__prepend {
          color: $field-disabled-input-color;
        }
        .q-field__control-container {
          .q-field__native {
            color: $field-disabled-input-color;
            &::placeholder {
              color: $field-disabled-input-color;
            }
          }
          .q-field__label {
            color: $grey-4;
          }
        }
        .q-field__append {
          color: $field-disabled-input-color;
        }
      }
      .q-field__bottom {
        padding-top: $spacing-none;
        .q-field__messages {
          color: $grey-6;
        }
      }
    }
  }

  &.q-field--readonly {
    .q-field__inner {
      .q-field__control {
        $field-disabled-input-color: $light-disable;
        &::before {
          background: $field-disabled-background;
        }
        & > div {
          opacity: 1 !important;
        }
        .q-field__prepend {
          color: $field-disabled-input-color;
        }
        .q-field__control-container {
          .q-field__native {
            color: $field-disabled-input-color;
            &::placeholder {
              color: $field-disabled-input-color;
            }
          }
          .q-field__label {
            color: $color-text3;
          }
        }
        .q-field__append {
          color: $field-disabled-input-color;
        }
      }
      .q-field__bottom {
        padding-top: $spacing-none;
        .q-field__messages {
          color: $grey-6;
        }
      }
    }
  }

  &.q-field--error {
    .q-field__inner {
      .q-field__control {
        &::before {
          border-color: $error;
        }
        .q-field__append {
          &.q-anchor--skip {
            display: none;
          }
        }
      }
      .q-field__bottom {
        .q-field__messages {
          color: $error;
        }
      }
    }
  }
  &.no-title {
    .q-field__inner {
      .q-field__control {
        margin-top: 0;
      }
    }
  }
  &.q-field--with-bottom {
    padding-bottom: 0;
  }
  .q-field__before {
    height: $input-height;
  }
  .q-field__after {
    height: $input-height;
  }
  input:-webkit-autofill,
  input:-webkit-autofill:hover,
  input:-webkit-autofill:focus,
  input:-webkit-autofill:active {
    box-shadow: none;
    background-clip: text;
    -webkit-text-fill-color: inherit;
    animation-delay: 1s; /* Safari support - any positive time runs instantly */
    animation-name: autofill;
    animation-fill-mode: both;
  }

  @keyframes autofill {
    0%,
    100% {
      color: #666;
      background: transparent;
    }
  }
}

.q-field {
  @include q-field-mixin;
}

.q-textarea {
  .q-field__inner {
    .q-field__control {
      &::before {
        background: $field-background;
        border: 1.5px solid $grey-4;
        @include radius-2();
      }
      &::after {
        display: none;
      }
      .q-field__control-container {
        .q-field__native {
          padding: $space-2 $space-4;
        }
      }
    }
  }

  &.q-field--focused {
    .q-field__inner {
      .q-field__control {
        &::before {
          border-color: $primary;
        }
      }
    }
  }
}
